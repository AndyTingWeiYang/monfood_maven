<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MonFood-Demo</title>
    <!-- w3c.js 引入共用畫面 -->

    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script src="/monfood_maven/assets/js/jQuery-3.6.0.js"></script>
    <link
      rel="stylesheet"
      href="/monfood_maven/assets/css/user-member-center-style/friendList.css"
    />
  </head>
  <script>
    // <jsp:include page="head.jsp" /> 即可移除以下 <script>
    document.addEventListener("DOMContentLoaded", function () {
      w3.includeHTML(function () {
        var scriptObj = document.querySelectorAll(
          'script[src^="/monfood_maven/assets"]'
        );

        for (var i = 0; i < scriptObj.length; i++) {
          var scriptElement = document.createElement("script");
          scriptElement.src = scriptObj[i].getAttribute("src");

          document.head.appendChild(scriptElement);
        }
      });
    });
  </script>

  <body>
    <div class="container-scroller">
      <div w3-include-html="sidebar.html"></div>
      <div class="container-fluid page-body-wrapper">
        <div w3-include-html="header.html"></div>
        <div class="main-panel">
          <div class="mf-content-wrapper-user-3">
            <!-- 內容都寫在content-wrapper -->
            <div class="mf-test-test">
              <h6>好友列表</h6>
            </div>

            <!-- 測試 -->
            <img id="image" src="" alt="" />

            <div id="friendList" class="list-group">
              <!-- 搜尋框 -->
              <!-- <form
                id="searchForm"
                class="form-inline active-pink-3 active-pink-4"
              >
                <input
                  class="form-control form-control-sm ml-3 w-75"
                  type="text"
                  placeholder="Search"
                  aria-label="Search"
                />
                <!-- searchIcon -->
              <!-- <button id="searchBtn">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    id="searchIcon"
                    width="16"
                    height="16"
                    fill="currentColor"
                    class="bi bi-search"
                    viewBox="0 0 16 16"
                  >
                    <path
                      d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                    />
                  </svg>
                </button>
              </form> -->

              <!-- 訊息列表 -->

              <!-- 好友列表-->

              <!-- <div id="friendListDiv">
                <div class="d-flex w-100">
                  <h5 id="avatarList" class="mb-1"></h5>
                  <p id="friendName">David</p>
                  <div id="removeBtnDiv">
                    <button
                      class="nd3 nds"
                      data-toggle="tooltip"
                      data-placement="left"
                      data-bs-toggle="modal"
                      data-bs-target="#friendInfoModal"
                      id="removeBtn"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-eye"
                        viewBox="0 0 16 16"
                      >
                        <path
                          d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"
                        />
                        <path
                          d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div> -->

              <!-- 好友資訊頁面Modal -->
              <!-- <div
                class="modal fade"
                id="friendInfoModal"
                tabindex="-1"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div id="modalHeader" class="modal-header">
                      <h5>
                        <span class="logo">Mon</span
                        ><span class="logo2">Food</span>
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>
                    <h4 id="title">好友資訊</h4>
                    <div id="waitPairInfo" class="col align-self-center">
                      <div id="info">姓名</div>
                      <div id="name">吳宜玲</div>
                      <hr id="info" />

                      <div id="info">生日</div>
                      <div id="birthday">1998年1月31日</div>
                      <hr id="info" />

                      <div id="info">小怪獸等級</div>
                      <div id="level">1</div>
                      <hr id="info" />

                      <div id="info">自我介紹</div>
                      <div id="introduction">
                        我的外號是「米奇」，
                        只因為換了去迪士尼戴米老鼠帽子的大頭貼，
                        辦公室同事就幫我取了這個外號，
                        希望可以找到願意讓我帶妳去迪士尼玩的米妮。
                      </div>
                      <hr id="info" />
                    </div>
                  </div>
                </div>
              </div> -->

              <script>
                window.onload = function () {
                  $.ajax({
                    url: "http://localhost:8080/monfood_maven/PairListServlet",
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                      // console.log(data);
                      for (var i = 0; i < data.length; i++) {
                        var base64String = btoa(
                          String.fromCharCode.apply(
                            null,
                            new Uint8Array(data[i].profilePic)
                          )
                        );
                        // console.log(base64String);
                        var html = "";
                        html += `  <div id="friendListDiv">
                <div class="d-flex w-100">
                  <h5 class="mb-1 avatarList"></h5>
                  <p id="friendName">${data[i].userName}</p>
                  <div id="removeBtnDiv">
                    <button
                      class="nd3 nds"
                      data-toggle="tooltip"
                      data-placement="left"
                      data-bs-toggle="modal"
                      data-bs-target="#friendInfoModal${data[i].userId}";
                      id="removeBtn"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-eye"
                        viewBox="0 0 16 16"
                      >
                        <path
                          d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"
                        />
                        <path
                          d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
              
              <div
                class="modal fade"
                id="friendInfoModal${data[i].userId}"
                tabindex="-1"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div id="modalHeader" class="modal-header">
                      <h5>
                        <span class="logo">Mon</span
                        ><span class="logo2">Food</span>
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>
                    <h4 id="title">好友資訊</h4>
                    <div id="waitPairInfo" class="col align-self-center">
                      <div id="info">姓名</div>
                      <div id="name">${data[i].userName}</div>
                      <hr id="info" />

                      <div id="info">生日</div>
                      <div id="birthday">${data[i].birthday}</div>
                      <hr id="info" />

                      <div id="info">小怪獸等級</div>
                      <div id="level">${data[i].monsLevel}</div>
                      <hr id="info" />

                      <div id="info">自我介紹</div>
                      <div id="introduction">
                        ${data[i].userProfile}
                      </div>
                      <hr id="info" />
                    </div>
                  </div>
                </div>
              </div>
              `;

                        $("#friendList").append(html);
                        console.log(document.querySelectorAll(".avatarList"));
                        document.querySelectorAll(".avatarList")[
                          i
                        ].style.backgroundImage =
                          "url('data:image/png;base64," + base64String + "')";

                        // document
                        //   .querySelectorAll(".avatarList")
                        //   [i].css(
                        //     "background-image",
                        //     "url('data:image/png;base64," + base64String + "')"
                        //   );
                      }
                    },
                  });
                };

                // w3.includeHTML(function () {
                //   $(document).on("click", "#removeBtn", function () {
                //     let yes = confirm(
                //       "確認刪除此位好友? 您將永遠無法與他成為好友"
                //     );
                //     if (yes) {
                //       $(this).parent().parent().parent().remove();
                //     }
                //   });
                // });
              </script>
            </div>
          </div>
          <div w3-include-html="footer.html"></div>
        </div>
      </div>
    </div>
  </body>
</html>
