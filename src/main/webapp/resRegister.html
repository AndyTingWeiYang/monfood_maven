<!doctype html>
<html lang="en"> 
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>MonFood | resRegister</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
      <link rel="stylesheet" href="./css/index.css">
      <!-- verification code -->
      <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css" integrity="sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5" crossorigin="anonymous">
      

      <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
     
      .container{
        width: 75%;
      }

      button.btn.btn-primary{
        background-color: #946c51;
        border: #946c51;
      }

      .form-group{
        height:calc(100vh - 56px);
        display: flex;
        justify-content: center; /* 水平對齊 */
        align-content: center; /* 垂直對齊 */
        margin-top: 0%;
      }
      @media (max-width: 629.98px){
        .form-group{
          align-items: baseline;
          align-content: flex-start;
        }
      }
      
      @media (max-width: 768.98px){
        .btn{
          width:100% ;
        }
      }
      
     .check{
        display: flex;
        justify-content: center;
        align-items: center
      }

      .form-check-label>a:link{
        /* 設定還沒有瀏覽過的連結 */
        text-decoration:none;
        background-color:#ffffff;
        color: blue;
      }
      .form-check-label>a:visited {
        /* 設定已經瀏覽過的連結 */
        color:gray;
        /* background-color:rgb(174, 174, 174); */
      }
      .form-check-label>a:hover {
        /* 設定滑鼠移經的連結 */
        text-decoration:underline;
        color:gray;
      }
      .form-check-label>a:active {
        /* 設定正在點選的連結 */
        text-decoration:none;
        /* background-color:gray; */
        color:gray;
      }

      .noticespan {
        color: red;
        font-size: 10px;
      }

      .passspan{
        color: green;
        font-size: 10px;
      }

      #mycanvas{cursor: pointer;text-align:center}
      </style>
  </head>
  
  <body>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
      
      <!-- navbar -->
      <header>
        <nav class="navbar navbar-expand-lg" style="background-color: #946c51">
          <div class="container">
            <a class="navbar-brand d-inline-flex" href="#">   <!-- 要改轉向網址 -->
              <span class="logo">Mon</span>
              <span class="logo2" style="color: white;">Food</span>
            </a>
          </div>
        </nav>
      </header>
      <!-- navbar -->
      
      <main>
        <!-- section -->
      <div class="container">
        <div class=" row mx-auto">

            <div class="row g-3 form-group">
                <div class="col-12">
                  <h3 style="text-align: center">商家免費註冊</h3>
                </div>
               
               
                <div class="col-md-10 col-12">
                  <input type="text" class="form-control" id="resname" placeholder="商家名稱" required />
                  <span class="noticespan namespan"></span>
                </div>
  
                <div class="col-md-10 col-12">
                  <input type="text" class="form-control" id="resaccount" placeholder="統一編號(帳號)" maxlength="8" required />
                  <span class="noticespan accountspan1"></span>
                  <span class="accountspan2"></span>
                </div>
  
                <div class="col-md-10 col-12">
                  <input type="password" class="form-control" id="respassword" placeholder="會員密碼" required />
                  <span class="noticespan passwordspan"></span>
                </div>
  
                <div class="col-md-10 col-12">
                  <input type="password" class="form-control" id="password-check" placeholder="確認密碼" required />
                  <span class="noticespan passwordcheckspan"></span>

                </div>
  
                <div class="col-md-10 col-12">
                  <input type="tel" class="form-control" id="resphone-num" placeholder="聯絡人手機號碼" maxlength="10" required />
                  <span class="noticespan phonenumspan"></span>
                </div>       
                
                <div class="col-md-8 col-12">
                  <input class="form-control col-md-12" id="myvad" type="text" name="vad" placeholder="請輸入驗證碼" maxlength="4" >
                  <span class="noticespan vadspan"></span>
                </div>

                <div class="col-12 col-md-2 d-flex justify-content-center">
                  <canvas id="mycanvas" width='100' height='40' ></canvas>                      
                </div>
  
                <div class="col-md-8 check">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="gridCheck" required/>
                    <label class="form-check-label" for="gridCheck">
                      已確認以上資料無誤，並同意接受 <a class="policy" href="#" data-bs-toggle="modal" data-bs-target="#memberPolicy">會員條款及隱私政策</a>。
                    </label>
                  </div>
                </div>
                <!-- 會員條款及隱私政策彈窗 -->
                <div class="modal fade" id="memberPolicy" tabindex="-1" aria-labelledby="exampleModalFullscreenSmLabel" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-scrollable">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title h4" id="exampleModalFullscreenSmLabel">會員條款及隱私政策</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <!-- 會員條款及隱私政策內容 -->
                        <pre>
        【  會員服務條款  】
        ●本會員服務條款所稱之「會員」，為依照本站所定之加入會員程序加入完成並通過認證者。
        ●當您使用本站服務時，即表示您同意及遵守本服務條款的規定事項及相關法律之規定。
        ●本站保留有審核加入會員資格之權利，另外已加入會員者，本站亦保留有解除其會員資格之權利。
        ●本會員服務條款之修訂，適用於所有會員，當本站修訂本服務條款時，將於本站上公告。
        會員
        ●使用本站所提供之會員服務時，於加入會員時所登錄之帳號及密碼使用之。
        ●會員須善盡帳號及密碼的使用與管理之責任。對於使用該會員之帳號及密碼(無關於會員本身或其他人)利用本站服務所造成或衍生之所有行為及結果，會員須自行負擔全部責任。
        ●會員之帳號及密碼遺失，或發現無故遭第三者盜用時，應立即通知本站連絡掛失，因未即時通知，導致本站無法有效防止及修改時，所造成的所有損失，會員應自負全責。
        ●每次結束使用本服務，執行會員之登出並關閉視窗，以確保您的會員權益。
        ●盜用第三者會員之帳號及密碼，導致第三者或本公司遭其他第三人或行政機關之調查或追訴時，第三者會員或本公司有權向您請求損害賠償，包括但不限於訴訟費用、律師費及商譽損失等。

        會員登錄資料
        ●會員登錄資料須提供您本人正確、最新及完整的資料。
        ●會員登錄資料不得有偽造、不實等之情事(EX如個人資料及信用卡資料)，一經發現本公司可拒絕其加入會員資格之權利。並得以暫停或終止其會員資格，若違反中華民國相關法律，亦將依法追究。
        ●會員基本資料(EX:住址，電話及其他登錄資料)有變更時，請不定期更新相關個人資料，確保其正確及完整性。若您提供的資料有錯誤或不符等現象，本網站有權暫停或終止您的帳號，並拒絕您繼續使用本服務。
        ●未經會員本人同意，本公司原則上不會將涉及個人隱私之資料開示給第三者，唯資料共用原則…等不在此限(請參閱本站「隱私權保護聲明」相關規定)。
        ●會員應妥善保管密碼，不可將密碼洩露或提供給他人知道或使用；以同一個會員身分證字號和密碼使用本服務所進行的所有行為，都將被認為是該會員本人和密碼持有人的行為。
        ●會員如果發現或懷疑有第三人使用其會員身分證字號或密碼，應該立即通知本公司，採取必要的防範措施。但上述通知不得解釋為本公司對會員負有任何形式之賠償或補償之責任或義務。

        使用行為
        1. 您使用本服務之一切行為必須符合當地或國際相關法令規範；對於使用者的一切行為，您須自行負擔全部責任。
        2. 您同意絕不為非法之目的或以非法方式使用本服務，與確實遵守中華民國相關法規及網際網路之國際慣例，並保證不得利用本服務從事侵害他人權益或違法之行為。
        3. 您於使用本站會員服務時應遵守以下限制：
          (1)有損他人人格或商標權、著作權等智慧財產權或其他權利內容。
          (2)使用違反公共秩序或善良風俗或其他不法之文字。
          (3)強烈政治、宗教色彩的偏激言論。
          (4)未經本公司許可，不得利用本服務或本網站所提供其他資源，包括但不限於圖文資料庫、編寫製作網頁之軟體等，從事任何商業交易行為，或招攬廣告商或贊助人。
          (5)其他違反本站「會員服務條款」的內容。

        本公司專有權利
        ●本服務所載，或本服務所連結之一切軟體或內容，或本公司之廣告商或合夥人所提供之內容，均受其著作權或其他專有權利或法律所保障。
        ●當您傳輸資料至本公司提供之服務時，您即同意此一資料為全開放性(任何人均可瀏覽)。您授權並許可本公司得以重製、修飾、改編或以其他形式使用該內容之全部或一部分，及利用該內容製作衍生著作。衍生著作之著作權悉歸本公司所有。
        ●本公司同意除依本使用條款約定，將前述您的資料及衍生著作置於本網站供網路使用者瀏覽，以及本公司所屬相關媒體外，絕不非法轉供其他直接營利目的或侵害您的權利之使用。
        ●所有網頁之頁面出現之廣告看板與活動訊息，所有權及經營權均為本公司所有，使用者除事先取得本公司同意外，不得自行使用所有訊息。
        ●會員同意並授權本網站，得為提供個人化服務或相關加值服務之目的，提供所需之會員資料給合作單位(第三者)做約定範圍內之運用，如會員不同意將其資料列於合作單位(第三者)產品或服務名單內，可通知本網站於名單中刪除其資料，並同時放棄其本網站以外之購物優惠或獲獎權利。
        ●同時為提供行銷、市場分析、統計或研究、或為提供會員個人化服務或加值服務之目的，會員同意本公司、或本公司之策略合作夥伴，得記錄、保存、並利用會員在本網站所留存或產生之資料及記錄，同時在不揭露各該資料之情形下得公開或使用統計資料。
        ●對於會員所登錄之個人資料，會員同意本網站得於合理之範圍內蒐集、處理、保存、傳遞及使用該等資料，以提供使用者其他資訊或服務、或作成會員統計資料、或進行關於網路行為之調查或行銷研究。

        終止授權
        您使用本服務之行為若有任何違反法令或本使用條款或危害本網站或第三者權益之虞時，本公司有權不經告知您，立即暫時或永久終止您使用本服務之授權。
        免責事項
        1.下列情形發生時，本網站有權可以停止、中斷提供本服務：
          (1)對本服務相關軟硬體設備進行更換、升級、保養或施工時。
          (2)發生突發性之電子通信設備故障時。
          (3)天災或其他不可抗力之因素致使本網站無法提供服務時。
        2.本公司對於使用者在使用本服務或使用本服務所致生之任何直接、間接、衍生之財產或非財產之損害，不負賠償責任。
        3.使用者對於上傳留言之文字、圖片及其它資料，應自行備份；本公司對於任何原因導致其內容全部或一部之滅失、毀損，不負任何責任。
        4.本公司對使用本服務之用途或所產生的結果，不負任何保證責任，亦不保證與本服務相關之軟體無缺失或會予以修正。
        5.對於您在本站中的所有言論、意見或行為僅代表您個人；不代表本公司的立場，本公司不負任何責任。本公司對於使用者所自稱之身分，不擔保其正確性。
        6.本公司無須對發生於本服務或透過本服務所涉及之任何恐嚇、誹謗、淫穢或其他一切不法行為對您或任何人負責。
        7.對於您透過本服務所購買或取得，或透過本公司之贊助者或廣告商所刊登、銷售或交付之任何貨品或服務，您應自行承擔其可能風險或依法向商品或服務提供者交涉求償，與本公司完全無關，本公司均不負任何責任。

        修改權
        ●當您開始使用本服務時，即表示您已充分閱讀、瞭解與同意接受本條款之內容。本公司有權於任何時間修改與變更本條款之內容，並將不個別通知會員，建議您定期查閱本服務條款。如您於本條款修改與變更後仍繼續使用本服務，則視為您已閱讀、瞭解與同意接受本條款修改或變更。
        ●本公司有權暫時或永久修改或中止提供本服務給您，您不得因此要求任何賠償。

        智慧財產權保護
        ●本網站所使用之軟體、程式及網站上所有內容，包括但不限於著作、圖片、檔案、資訊、資料、網站架構、網頁設計，均由本網站或其他權利人依法擁有其智慧財產權，包括但不限於商標權、專利權、著作權、營業秘密與專有技術等。
        ●任何人不得逕行使用、修改、重製、公開播送、改作、散布、發行、公開發表、進行還原工程、解編或反向組譯。如欲引用或轉載前述之軟體、程式或網站內容，必須依法取得本網站或其他權利人的事前書面同意。如有違反之情事，您應對本網站或其他權利人負損害賠償責任（包括但不限於訴訟費用及律師費用等）。

        其他規定
        ●本網站使用者條約，免責之內容，亦構成本使用條款之一部分。
        ●若因您使用本服務之任何行為，導致本公司遭第三人或行政機關之調查或追訴時，本公司有權向您請求損害賠償，包括但不限於訴訟費用、律師費及商譽損失等。

        本公司針對可預知之軟硬體維護工作，有可能導致系統中斷或是暫停者，將會於該狀況發生前，以適當之方式告知會員。

        會員身分終止與本公司通知之義務
        ●本公司具有更改各項服務內容或終止任一會員帳戶服務之權利。
        ●若會員決定終止本公司會員資格，可直接以電子郵件的方式通知本公司或是由本公司所提供之機制進行取消，本公司將儘快註銷您的會員資料。
        ●會員有通知取消本公司會員資格之義務，並自停止本公司會員身份之日起（以本公司電子郵件發出日期為準），喪失所有本服務所提供之優惠及權益。
        ●為避免惡意情事發生致使會員應享權益損失，當會員通知本公司停止會員身份時，本公司將再次以電子郵件確認無誤後，再進行註銷會員資格。
        【隱私權政策】
        為了讓您瞭解當您造訪我們的網站時，所享有關於個人資料（個人資料是指得以識別您的身分且未公開的資料，如姓名、地址、電子郵件地址或電話號碼）保護的權利，我們將逐項說明如下，若有任何意見或疑問，歡迎您與我們聯絡。

        隱私權政策適用範圍

        隱私權政策適用於您使用本網站服務時所提供的個人資料。您經由本網站所提供的連結點選進入其他網站時，您在該網站中不適用本網站的隱私權保護政策。
        我們在何種情況下蒐集您的資料
        ●本網站為了更準確的提供您服務或回覆您的問題，因而需要請您在下列情況下提供個人相關資料：
        1.當您要加入本網站會員以獲得我們的會員服務時
        2.當您要向本網站洽詢服務訊息時
        3.當您要參加我們所舉辦的活動，並採取線上報名時
        4.當您要向本網站索取服務時，不論該服務是有價或無價
        我們如何運用您所登錄的個人資料
        我們所收集的個人資料，主要用途是使我們得以更準確的提供產品或服務給客戶、滿足客戶的需求、或通知客戶有關本網站最新的產品與服務。我們亦可能為內部目的使用個人資料，例如：稽核、資料分析及研究等，以改進我們的產品、服務、網頁呈現方式、及與客戶的溝通管道。本網站在未經您同意前，絕不會將您所登錄的個人資訊揭露、租借或轉售給第三者，或是將您的資料使用於未事先告知您的其他用途。
        關於您個人資料的修改與刪除
        當您在本網站註冊成為會員後，您可以隨時利用您的ID和密碼更改或刪除您原先提供的資料，以確保其正確性。
        我們何時必須將您的資訊接露
        ●本網站不會在未經您同意的狀況下向任何人或公司出售或出借您的個人資料。但在某些情況下會有例外。這些狀況包括（但不限於）：
        1.當您在本網站的行為已違反本網站的服務條款，或可能損害或妨礙本網站權益，或您的行為已導致任何人遭受損害，只要我們相信揭露您的個人資料是為了辨識、聯絡或採取法律行動所必要者。
        2.司法單位或其他有權機關因公眾安全，要求本網站公開特定個人資料時，本網站將視司法單位合法正式的程序，以及對本網站所有使用者安全考量下做可能必要的配合時。

        關於COOKIE的使用
        本網站有可能在您的電腦設定並取用本網站COOKIES，以提供貼心便利的各項服務。COOKIE是網站伺服器用來和使用者瀏覽器進行溝通的一種技術，它可能在使用者的電腦中儲存某些資訊，但是使用者可以藉由瀏覽器的設定，取消或限制此項功能，此項功能的取消將會造成您不能正常使用本網站的部分主要功能。

        帳號及個人資料隱私保護
        ●為保障您的隱私及安全，您的帳號資料會用密碼保護。
        ●當您要編輯會員資料等部分擁有個人資料及隱私頁面時，本網站會要求您輸入帳號識別資料確認身分。
        ●為確保您的帳號及個人資料安全無虞，本網站除了致力推廣各項安全機制外，同時也請您務必要定期更新您的作業系統並注意防毒。

        隱私權條款的修改
        由於科技發展的迅速，相關法規訂定未臻完備，以及未來可能難以預見的環境變遷等因素，本網站將會視需要修改我們在網站上所提供的隱私權說明，以落實保障您隱私權之立意。當我們完成隱私權條款修改時，我們會立即將其刊登於本網站的網站中，並以醒目標示提醒您前往點選閱讀。
                        </pre>  
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
                        <button type="button" class="btn btn-primary" id="agree-policy" data-bs-dismiss="modal">已詳閱並同意</button>
                      </div>
                    </div>
                  </div>
                </div>


                <div class="col-12 col-md-2 d-flex justify-content-center">
                  <button type="button" class="enter btn btn-primary">送出</button>
                </div>
              </div>
        </div>
      </div>
        
        <!-- section -->
      </main>
      
      <script src="assets/js/jQuery-3.6.0.js"></script>

  
      <script>
        
        $(function(){
          // 姓名驗證
          $("#resname").on("blur",function(){
            if($("#resname").val().trim() == ""){
              $(".namespan").addClass("noticespan").text('*請輸入完整姓名');               
            }else{
              $(".namespan").removeClass("noticespan").text('');              
            }
          });
          
          // 統編驗證
          $("#resaccount").on("blur",function(){
            var pattern = /^\d{8}$/;
            if($("#resaccount").val().trim() == ""){
              $(".accountspan2").text('');
              $(".accountspan1").addClass("noticespan").text('*請輸入完整統一編號');
            }else if(!(pattern.test($("#resaccount").val().trim()))){
              $(".accountspan2").text('');
              $(".accountspan1").addClass("noticespan").text('*請輸入正確格式');
            }else{
              $(".accountspan1").removeClass("noticespan").text('');
            }
          });
          
          // 密碼驗證
          // 以下是這個正規表示式的 pattern 的內容:
          // 密碼長度須超過八個字 {8,}
          // 密碼複雜度須包含:
          // - 小寫字母 [a-z]
          // - 大寫字母 [A-Z]
          // - 數字 \d
          $("#respassword").on("blur",function(){
            var pattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
            if($("#respassword").val().trim() == ""){
              $(".passwordspan").addClass("noticespan").text('*請輸入密碼');  
            }else if(!(pattern.test($("#respassword").val().trim()))){
              $(".passwordspan").addClass("noticespan").text(`*密碼長度須至少八個字元。密碼複雜度須包含:小寫字母、大寫字母、數字`); 
            }else{
              $(".passwordspan").removeClass("noticespan").text('');
            }
          });
         
          // 確認密碼驗證
          $("#password-check").on("blur",function(){
            if($("#password-check").val().trim() == ""){
              $(".passwordcheckspan").addClass("noticespan").text('*請再次輸入密碼');            
            }else if($("#password-check").val() != $("#respassword").val()){
              $(".passwordcheckspan").addClass("noticespan").text('*請與密碼輸入一致');  
            }else{
              $(".passwordcheckspan").removeClass("noticespan").text('');             
            }   
          });
          
          // 手機號碼驗證
          $("#resphone-num").on("blur",function(){
            var pattern = /[0-9]/;
            if($("#resphone-num").val().trim() == ""){
              $(".phonenumspan").addClass("noticespan").text('*請輸入手機號碼');  
            }else if(!(pattern.test($("#resphone-num").val().trim()))){
              $(".phonenumspan").addClass("noticespan").text('*請輸入數字');               
            }else if($("#resphone-num").val().trim().length<10){
              $(".phonenumspan").addClass("noticespan").text('*手機號碼格式錯誤'); 
            }else if(!(/^09/.test($("#resphone-num").val()))){
              $(".phonenumspan").addClass("noticespan").text('*手機號碼開頭為09'); 
            }else{
              $(".phonenumspan").removeClass("noticespan").text('');
            }
          });
         
          // 會員條款checked連動checkbox checked
          $("#agree-policy").on("click",function(){
            $("#gridCheck").prop("checked", true);
          });
        });      
       
        // 發ajax確認是否有帳號重複
        $("#resaccount").on("focusout",function(){
          if($("#resaccount").val().trim() != ""){
            $.ajax({
              url: "ResAccountPassServlet",         
              type: "POST",                  
              data: JSON.stringify({             
                "resAccount": $("#resaccount").val().trim(),          
              }),            
              contentType : "application/json;charset=utf-8",
              dataType: "json",             
              success: function(data){      // request 成功取得回應後執行
                console.log(data);
                if(data.checkAccountSuccess == "Success" && !($(".accountspan1").hasClass("noticespan"))){
                  $(".accountspan2").removeClass("noticespan");
                  $(".accountspan2").addClass("passspan").text('此帳號可以使用'); 
                }
                if(data.checkAccountFailed == "Failed"){
                  $(".accountspan2").removeClass("passspan");
                  $(".accountspan2").addClass("noticespan").text('*此帳號已被使用'); 
                }
              },
              error: function(xhr){         // request 發生錯誤的話執行
                console.log(xhr);
                // $(".accountspan2").addClass("noticespan").text('*此帳號已被使用');
              }

            });
          }
        });
        // 消除ajax發出後的錯誤提示
        $("#resaccount").on("blur",function(){
          if($("#resaccount").val().trim() != ""){
            $(".accountspan2").text('');
          }
        });

        // 驗證碼驗證
        varmycanvas=document.getElementById('mycanvas');
        var cxt=mycanvas.getContext('2d');//canvas getContext 渲染環境
        var validate="";
        var baseColor=["#0000ff","#CE0000","#7E3D76","#46A3FF"];//底色
        var sColor=["#B22222","#F9F900","#82D900","#FFAF60"];   //干擾點顏色
        var fColor=["#FFA07A","#00BB00","#EAC100","#F75000"];   //文字顏色
        var indexColor=""; //顏色組序號

        /*生成隨機顏色組合序號*/
        function randColor(){
          indexColor="";
          indexColor=Math.floor(Math.random()*baseColor.length); //亂數取得 0~顏色陣列長度
          return  indexColor;
        }

        /*生成6位隨機數*/
        function rand(){
          validate="";
          // 大小寫英文 數字 排除 I l o O 0  ,並重複數字 增加出現機率
          var str="123456789abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789";
          var arr=str.split("");
          var ranNum;
          for(var i=0;i<4;i++){
              ranNum=Math.floor(Math.random()*66);   //隨機數在[0,65]之間
              validate+=arr[ranNum];
          }
          //alert("rand() "+validate);
          //alert("rand() "+typeof(validate));
          return validate;
        }

        /*干擾線的隨機x坐標值*/
        function lineX(){
          var ranLineX=Math.floor(Math.random()*150);
          return ranLineX;
        }

        /*干擾線的隨機y坐標值*/
        function lineY(){
          var ranLineY=Math.floor(Math.random()*40);
          return ranLineY;
        }

        /*更換內容*/
        function clickChange(){ 
          var i=randColor(); //執行randColor()取得顏色組序號
          //alert(i);
          cxt.beginPath();
          cxt.fillStyle=baseColor[i];//底色
          cxt.fillRect(0,0,150,40);//(x,y,width,height)
          
          /*生成干擾點 40*/
          for(var j=0;j<40;j++){
              
            //產生一個新路徑，產生後再使用繪圖指令來設定路徑 
            //若省略beginPath，則每點擊一次驗證碼會累積干擾線的條數
            cxt.beginPath();
            cxt.fillStyle = sColor[i];//顏色
            var arcSize=(Math.floor(Math.random()*(50-5+1))+5)/10; //亂數 取得介於0.5~5之間的值
            cxt.arc(lineX(), lineY(), arcSize, 0, 2 * Math.PI);  //arc()產生一個圓形  context.arc(x,y,r,sAngle,eAngle,counterclockwise);
            cxt.fill();

          }
          cxt.fillStyle=fColor[i];//隨機文字顏色
          cxt.font='bold 25px Verdana';
          cxt.fillText(rand(),10,30);   //把rand()生成的隨機數文本填充到canvas中      
        }

        /*點擊驗證碼更換*/
        mycanvas.onclick=function(e){
          e.preventDefault();   //阻止滑鼠點擊發生預設的行為
          clickChange();
        }

        /*輸入驗證碼與核對 正確發ajax*/
        $(".enter").on("click",function(e){
          var vad = $("#myvad").val();
          console.log(vad);

          if(vad===validate){
            $(".vadspan").removeClass("noticespan").text('');
            $("#myvad").val("");
            clickChange();
// 這邊以下
            if($("span").hasClass("noticespan")){
            alert("註冊尚未成功");
            return;
            }
            // 註冊資料發出給伺服器
            $.ajax({
            url: "ResRegisterServlet",           
            type: "POST",                  
            data: JSON.stringify({
              "resName": $("#resname").val().trim(),
              "resAccount": $("#resaccount").val().trim(),
              "resPassword": $("#respassword").val().trim(),
              "ownerTel": $("#resphone-num").val().trim()   
            }),             
            contentType : "application/json;charset=utf-8",
            dataType: "json",             
            success: function(data){      // request 成功取得回應後執行
              window.location.replace("./resRegisterSuccess.html");    
            }
          });
            
          }
          else{
            $(".vadspan").addClass("noticespan").text('*驗證碼有誤');
            $("#myvad").val("");
          }

// 這邊以上
          e.preventDefault();

        });

        clickChange();
      
        $("#myvad").on("blur",function(){
          $(".vadspan").removeClass("noticespan").text('');
        })


      




        


        // // 註冊資料發出給伺服器
        // $(".enter").on("click",function(){
        //   if($("span").hasClass("noticespan")){
        //     alert("註冊尚未成功");
        //     return;
        //   }
        //   $.ajax({
        //     url: "ResRegisterServlet",           
        //     type: "POST",                  
        //     data: JSON.stringify({
        //       "resName": $("#resname").val().trim(),
        //       "resAccount": $("#resaccount").val().trim(),
        //       "resPassword": $("#respassword").val().trim(),
        //       "ownerTel": $("#resphone-num").val().trim()   
        //     }),             
        //     contentType : "application/json;charset=utf-8",
        //     dataType: "json",             
        //     success: function(data){      // request 成功取得回應後執行
        //       location.href="./resRegisterSuccess.html";      
        //     }
        //   });
        // });

      </script>
      
  </body>
</html>