<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>MonFood</title>
    <link rel="stylesheet" href="/assets/css/jquery.dataTables.min.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css"
    />
    <!-- w3c.js 引入共用畫面 -->
  </head>

  <body>
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script src="assets/js/jQuery-3.6.0.js"></script>
    <script src="/assets/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <div class="container-scroller">
      <!-- ===== sidebar start ===== -->
      <!-- TODO: 未來 JSP <jsp:include page="sidebar.jsp" /> 取代 -->
      <div w3-include-html="adminSidebar.html"></div>
      <!-- ===== sidebar end ===== -->

      <div class="container-fluid page-body-wrapper">
        <!-- ===== header start ===== -->
        <!-- TODO: 未來 JSP <jsp:include page="header.jsp" /> 取代 -->
        <div w3-include-html="adminHeader.html"></div>
        <!-- ===== header end ===== -->

        <div class="main-panel">
          <!-- ===== 內容客製化區塊 start ===== -->
          <div class="mf-content-wrapper mt-4">
            <!-- 表單區塊-->
            <div class="container">
              <table id="prductList" class="display" style="width: 100%">
                <thead>
                  <tr>
                    <th>優惠券編號</th>
                    <th>優惠券名稱</th>
                    <th>優惠折抵</th>
                    <th>開始日期</th>
                    <th>結束日期</th>
                    <th>狀態</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="content"></tbody>
              </table>
            </div>
          </div>
          <!-- ===== 內容客製化區塊 ===== -->

          <!-- ===== footer start ===== -->
          <!-- TODO: 未來 JSP <jsp:include page="footer.jsp" /> 取代 -->
          <div w3-include-html="adminFooter.html"></div>
          <!-- ===== footer end ===== -->
        </div>
      </div>
    </div>
    <script>
      // <jsp:include page="head.jsp" /> 即可移除以下 <script>
      document.addEventListener("DOMContentLoaded", function () {
        w3.includeHTML(function () {
          function init() {
            $("#prductList").DataTable();

            $("#manual-ajax").click(function (event) {
              event.preventDefault();
              this.blur(); // Manually remove focus from clicked link.
              $.get(this.href, function (html) {
                $(html).appendTo("body").modal();
              });
            });
          }

          var scriptObj = document.querySelectorAll('script[src^="assets"]');

          for (var i = 0; i < scriptObj.length; i++) {
            var scriptElement = document.createElement("script");
            scriptElement.src = scriptObj[i].getAttribute("src");

            document.head.appendChild(scriptElement);
          }
          init();
        });
      });
      //
      $(function () {
        const promoteId = $("#promoteId");

        $("#promoteId").on("blur", function () {
          $("#errMsg").text("");
        });

        // selectAll

        $("#selectAll").on("click", function () {
          let errMsg;

          $.ajax({
            url: "AdminPromoteListAllServlet",
            type: "POST",
            dataType: "json",
            // dataType: 'json',
            success: function (data) {
              console.log(data);
              console.log(data.PromoteList[1]);
              $("#errMsg").text("");

              if (data.errMsg == "系統錯誤") {
                errMsg = "*系統錯誤";
                $("#errMsg").text(errMsg);
                return;
              }

              let table_html = `
            <tr>
                <td>${data.PromoteList.promoteId}</td>
                <td>${data.PromoteList.promoteCode}</td>
                <td>${data.PromoteList.startDate}</td>
                <td>${data.PromoteList.endDate}</td>
                <td>${data.PromoteList.status}</td>

            </tr>
            `;

              $("#content").html(table_html);
            },
          });
        });
      });

      //
    </script>
  </body>
</html>
